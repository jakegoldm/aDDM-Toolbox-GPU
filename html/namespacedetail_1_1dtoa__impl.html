<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>aDDM-Toolbox-GPU: detail::dtoa_impl Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">aDDM-Toolbox-GPU
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedetail.html">detail</a></li><li class="navelem"><a class="el" href="namespacedetail_1_1dtoa__impl.html">dtoa_impl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">detail::dtoa_impl Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>implements the Grisu2 algorithm for binary to decimal floating-point conversion.  
<a href="namespacedetail_1_1dtoa__impl.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdetail_1_1dtoa__impl_1_1boundaries.html">boundaries</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdetail_1_1dtoa__impl_1_1cached__power.html">cached_power</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c879bf97b806cacbcbb2da07a5ff5c8"><td class="memTemplParams" colspan="2">template&lt;typename Target , typename Source &gt; </td></tr>
<tr class="memitem:a3c879bf97b806cacbcbb2da07a5ff5c8"><td class="memTemplItemLeft" align="right" valign="top">Target&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a3c879bf97b806cacbcbb2da07a5ff5c8">reinterpret_bits</a> (const Source source)</td></tr>
<tr class="separator:a3c879bf97b806cacbcbb2da07a5ff5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a5ccf11847aab7a0f42f587b33935df"><td class="memTemplParams" colspan="2">template&lt;typename FloatType &gt; </td></tr>
<tr class="memitem:a6a5ccf11847aab7a0f42f587b33935df"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structdetail_1_1dtoa__impl_1_1boundaries.html">boundaries</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a6a5ccf11847aab7a0f42f587b33935df">compute_boundaries</a> (FloatType <a class="el" href="namespacedetail.html#a47b1bb0bbd3596589ed9187059c312efa2063c1608d6e0baf80249c42e2be5804">value</a>)</td></tr>
<tr class="separator:a6a5ccf11847aab7a0f42f587b33935df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29ae6574f6be09a5c8ab08da9a3f71b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdetail_1_1dtoa__impl_1_1cached__power.html">cached_power</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a29ae6574f6be09a5c8ab08da9a3f71b4">get_cached_power_for_binary_exponent</a> (int e)</td></tr>
<tr class="separator:a29ae6574f6be09a5c8ab08da9a3f71b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04eb234a28617519974fc962cd4da666"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a04eb234a28617519974fc962cd4da666">find_largest_pow10</a> (const std::uint32_t n, std::uint32_t &amp;pow10)</td></tr>
<tr class="separator:a04eb234a28617519974fc962cd4da666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a15efcb5c2157ea0e1375b98ef0e83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a73a15efcb5c2157ea0e1375b98ef0e83">grisu2_round</a> (char *buf, int len, std::uint64_t dist, std::uint64_t delta, std::uint64_t rest, std::uint64_t ten_k)</td></tr>
<tr class="separator:a73a15efcb5c2157ea0e1375b98ef0e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae877aa13ab872c99a1c614e5e1524807"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#ae877aa13ab872c99a1c614e5e1524807">grisu2_digit_gen</a> (char *buffer, int &amp;length, int &amp;decimal_exponent, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_minus, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> w, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_plus)</td></tr>
<tr class="separator:ae877aa13ab872c99a1c614e5e1524807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad549352ed1a9676a092d143a2daa3dee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#ad549352ed1a9676a092d143a2daa3dee">grisu2</a> (char *buf, int &amp;len, int &amp;decimal_exponent, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> m_minus, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> v, <a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> m_plus)</td></tr>
<tr class="separator:ad549352ed1a9676a092d143a2daa3dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf6bc05c54068a5930f66c2e803e8b8"><td class="memTemplParams" colspan="2">template&lt;typename FloatType &gt; </td></tr>
<tr class="memitem:abdf6bc05c54068a5930f66c2e803e8b8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#abdf6bc05c54068a5930f66c2e803e8b8">grisu2</a> (char *buf, int &amp;len, int &amp;decimal_exponent, FloatType <a class="el" href="namespacedetail.html#a47b1bb0bbd3596589ed9187059c312efa2063c1608d6e0baf80249c42e2be5804">value</a>)</td></tr>
<tr class="separator:abdf6bc05c54068a5930f66c2e803e8b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9f6655c3b629aeb0e8c887aea5da87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="json_8hpp.html#a5f2aaec3b681d0a72f7d6e90b70cdcd1">JSON_HEDLEY_RETURNS_NON_NULL</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#aec9f6655c3b629aeb0e8c887aea5da87">append_exponent</a> (char *buf, int e)</td></tr>
<tr class="memdesc:aec9f6655c3b629aeb0e8c887aea5da87"><td class="mdescLeft">&#160;</td><td class="mdescRight">appends a decimal representation of e to buf  <br /></td></tr>
<tr class="separator:aec9f6655c3b629aeb0e8c887aea5da87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab91abfdd1cdf43cc2fcd5b9c4a7456"><td class="memItemLeft" align="right" valign="top"><a class="el" href="json_8hpp.html#a5f2aaec3b681d0a72f7d6e90b70cdcd1">JSON_HEDLEY_RETURNS_NON_NULL</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#afab91abfdd1cdf43cc2fcd5b9c4a7456">format_buffer</a> (char *buf, int len, int decimal_exponent, int min_exp, int max_exp)</td></tr>
<tr class="memdesc:afab91abfdd1cdf43cc2fcd5b9c4a7456"><td class="mdescLeft">&#160;</td><td class="mdescRight">prettify v = buf * 10^decimal_exponent  <br /></td></tr>
<tr class="separator:afab91abfdd1cdf43cc2fcd5b9c4a7456"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a95c569b7627a9372686f1f77d73e8660"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#a95c569b7627a9372686f1f77d73e8660">kAlpha</a> = -60</td></tr>
<tr class="separator:a95c569b7627a9372686f1f77d73e8660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae152a095d2dd1a6dd41ef8ad39c26e19"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetail_1_1dtoa__impl.html#ae152a095d2dd1a6dd41ef8ad39c26e19">kGamma</a> = -32</td></tr>
<tr class="separator:ae152a095d2dd1a6dd41ef8ad39c26e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>implements the Grisu2 algorithm for binary to decimal floating-point conversion. </p>
<p>This implementation is a slightly modified version of the reference implementation which may be obtained from <a href="http://florian.loitsch.com/publications">http://florian.loitsch.com/publications</a> (bench.tar.gz).</p>
<p>The code is distributed under the MIT license, Copyright (c) 2009 Florian Loitsch.</p>
<p>For a detailed description of the algorithm see:</p>
<p>[1] Loitsch, "Printing Floating-Point Numbers Quickly and Accurately with
    Integers", Proceedings of the ACM SIGPLAN 2010 Conference on Programming Language Design and Implementation, PLDI 2010 [2] Burger, Dybvig, "Printing Floating-Point Numbers Quickly and Accurately", Proceedings of the ACM SIGPLAN 1996 Conference on Programming Language Design and Implementation, PLDI 1996 </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aec9f6655c3b629aeb0e8c887aea5da87" name="aec9f6655c3b629aeb0e8c887aea5da87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec9f6655c3b629aeb0e8c887aea5da87">&#9670;&#160;</a></span>append_exponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="json_8hpp.html#a5f2aaec3b681d0a72f7d6e90b70cdcd1">JSON_HEDLEY_RETURNS_NON_NULL</a> char * detail::dtoa_impl::append_exponent </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>appends a decimal representation of e to buf </p>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the element following the exponent. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>-1000 &lt; e &lt; 1000 </dd></dl>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17749">17749</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17750</span>{</div>
<div class="line"><span class="lineno">17751</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(e &gt; -1000);</div>
<div class="line"><span class="lineno">17752</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(e &lt;  1000);</div>
<div class="line"><span class="lineno">17753</span> </div>
<div class="line"><span class="lineno">17754</span>    <span class="keywordflow">if</span> (e &lt; 0)</div>
<div class="line"><span class="lineno">17755</span>    {</div>
<div class="line"><span class="lineno">17756</span>        e = -e;</div>
<div class="line"><span class="lineno">17757</span>        *buf++ = <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><span class="lineno">17758</span>    }</div>
<div class="line"><span class="lineno">17759</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">17760</span>    {</div>
<div class="line"><span class="lineno">17761</span>        *buf++ = <span class="charliteral">&#39;+&#39;</span>;</div>
<div class="line"><span class="lineno">17762</span>    }</div>
<div class="line"><span class="lineno">17763</span> </div>
<div class="line"><span class="lineno">17764</span>    <span class="keyword">auto</span> k = <span class="keyword">static_cast&lt;</span>std::uint32_t<span class="keyword">&gt;</span>(e);</div>
<div class="line"><span class="lineno">17765</span>    <span class="keywordflow">if</span> (k &lt; 10)</div>
<div class="line"><span class="lineno">17766</span>    {</div>
<div class="line"><span class="lineno">17767</span>        <span class="comment">// Always print at least two digits in the exponent.</span></div>
<div class="line"><span class="lineno">17768</span>        <span class="comment">// This is for compatibility with printf(&quot;%g&quot;).</span></div>
<div class="line"><span class="lineno">17769</span>        *buf++ = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><span class="lineno">17770</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><span class="lineno">17771</span>    }</div>
<div class="line"><span class="lineno">17772</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; 100)</div>
<div class="line"><span class="lineno">17773</span>    {</div>
<div class="line"><span class="lineno">17774</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 10);</div>
<div class="line"><span class="lineno">17775</span>        k %= 10;</div>
<div class="line"><span class="lineno">17776</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><span class="lineno">17777</span>    }</div>
<div class="line"><span class="lineno">17778</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">17779</span>    {</div>
<div class="line"><span class="lineno">17780</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 100);</div>
<div class="line"><span class="lineno">17781</span>        k %= 100;</div>
<div class="line"><span class="lineno">17782</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 10);</div>
<div class="line"><span class="lineno">17783</span>        k %= 10;</div>
<div class="line"><span class="lineno">17784</span>        *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><span class="lineno">17785</span>    }</div>
<div class="line"><span class="lineno">17786</span> </div>
<div class="line"><span class="lineno">17787</span>    <span class="keywordflow">return</span> buf;</div>
<div class="line"><span class="lineno">17788</span>}</div>
<div class="ttc" id="ajson_8hpp_html_a69f131cff49da1989667220173fbeae6"><div class="ttname"><a href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a></div><div class="ttdeci">#define JSON_ASSERT(x)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l02544">json.hpp:2544</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a5ccf11847aab7a0f42f587b33935df" name="a6a5ccf11847aab7a0f42f587b33935df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5ccf11847aab7a0f42f587b33935df">&#9670;&#160;</a></span>compute_boundaries()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename FloatType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdetail_1_1dtoa__impl_1_1boundaries.html">boundaries</a> detail::dtoa_impl::compute_boundaries </td>
          <td>(</td>
          <td class="paramtype">FloatType&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the (normalized) diyfp representing the input number 'value' and its boundaries.</p>
<dl class="section pre"><dt>Precondition</dt><dd>value must be finite and positive </dd></dl>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17010">17010</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17011</span>{</div>
<div class="line"><span class="lineno">17012</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(std::isfinite(value));</div>
<div class="line"><span class="lineno">17013</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(value &gt; 0);</div>
<div class="line"><span class="lineno">17014</span> </div>
<div class="line"><span class="lineno">17015</span>    <span class="comment">// Convert the IEEE representation into a diyfp.</span></div>
<div class="line"><span class="lineno">17016</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17017</span>    <span class="comment">// If v is denormal:</span></div>
<div class="line"><span class="lineno">17018</span>    <span class="comment">//      value = 0.F * 2^(1 - bias) = (          F) * 2^(1 - bias - (p-1))</span></div>
<div class="line"><span class="lineno">17019</span>    <span class="comment">// If v is normalized:</span></div>
<div class="line"><span class="lineno">17020</span>    <span class="comment">//      value = 1.F * 2^(E - bias) = (2^(p-1) + F) * 2^(E - bias - (p-1))</span></div>
<div class="line"><span class="lineno">17021</span> </div>
<div class="line"><span class="lineno">17022</span>    <span class="keyword">static_assert</span>(std::numeric_limits&lt;FloatType&gt;::is_iec559,</div>
<div class="line"><span class="lineno">17023</span>                  <span class="stringliteral">&quot;internal error: dtoa_short requires an IEEE-754 floating-point implementation&quot;</span>);</div>
<div class="line"><span class="lineno">17024</span> </div>
<div class="line"><span class="lineno">17025</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span>      kPrecision = std::numeric_limits&lt;FloatType&gt;::digits; <span class="comment">// = p (includes the hidden bit)</span></div>
<div class="line"><span class="lineno">17026</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span>      kBias      = std::numeric_limits&lt;FloatType&gt;::max_exponent - 1 + (kPrecision - 1);</div>
<div class="line"><span class="lineno">17027</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span>      kMinExp    = 1 - kBias;</div>
<div class="line"><span class="lineno">17028</span>    <span class="keyword">constexpr</span> std::uint64_t kHiddenBit = std::uint64_t{1} &lt;&lt; (kPrecision - 1); <span class="comment">// = 2^(p-1)</span></div>
<div class="line"><span class="lineno">17029</span> </div>
<div class="line"><span class="lineno">17030</span>    <span class="keyword">using </span>bits_type = <span class="keyword">typename</span> std::conditional&lt;kPrecision == 24, std::uint32_t, std::uint64_t &gt;::type;</div>
<div class="line"><span class="lineno">17031</span> </div>
<div class="line"><span class="lineno">17032</span>    <span class="keyword">const</span> <span class="keyword">auto</span> bits = <span class="keyword">static_cast&lt;</span>std::uint64_t<span class="keyword">&gt;</span>(reinterpret_bits&lt;bits_type&gt;(value));</div>
<div class="line"><span class="lineno">17033</span>    <span class="keyword">const</span> std::uint64_t E = bits &gt;&gt; (kPrecision - 1);</div>
<div class="line"><span class="lineno">17034</span>    <span class="keyword">const</span> std::uint64_t F = bits &amp; (kHiddenBit - 1);</div>
<div class="line"><span class="lineno">17035</span> </div>
<div class="line"><span class="lineno">17036</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_denormal = E == 0;</div>
<div class="line"><span class="lineno">17037</span>    <span class="keyword">const</span> diyfp v = is_denormal</div>
<div class="line"><span class="lineno">17038</span>                    ? diyfp(F, kMinExp)</div>
<div class="line"><span class="lineno">17039</span>                    : diyfp(F + kHiddenBit, static_cast&lt;int&gt;(E) - kBias);</div>
<div class="line"><span class="lineno">17040</span> </div>
<div class="line"><span class="lineno">17041</span>    <span class="comment">// Compute the boundaries m- and m+ of the floating-point value</span></div>
<div class="line"><span class="lineno">17042</span>    <span class="comment">// v = f * 2^e.</span></div>
<div class="line"><span class="lineno">17043</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17044</span>    <span class="comment">// Determine v- and v+, the floating-point predecessor and successor if v,</span></div>
<div class="line"><span class="lineno">17045</span>    <span class="comment">// respectively.</span></div>
<div class="line"><span class="lineno">17046</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17047</span>    <span class="comment">//      v- = v - 2^e        if f != 2^(p-1) or e == e_min                (A)</span></div>
<div class="line"><span class="lineno">17048</span>    <span class="comment">//         = v - 2^(e-1)    if f == 2^(p-1) and e &gt; e_min                (B)</span></div>
<div class="line"><span class="lineno">17049</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17050</span>    <span class="comment">//      v+ = v + 2^e</span></div>
<div class="line"><span class="lineno">17051</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17052</span>    <span class="comment">// Let m- = (v- + v) / 2 and m+ = (v + v+) / 2. All real numbers _strictly_</span></div>
<div class="line"><span class="lineno">17053</span>    <span class="comment">// between m- and m+ round to v, regardless of how the input rounding</span></div>
<div class="line"><span class="lineno">17054</span>    <span class="comment">// algorithm breaks ties.</span></div>
<div class="line"><span class="lineno">17055</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17056</span>    <span class="comment">//      ---+-------------+-------------+-------------+-------------+---  (A)</span></div>
<div class="line"><span class="lineno">17057</span>    <span class="comment">//         v-            m-            v             m+            v+</span></div>
<div class="line"><span class="lineno">17058</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17059</span>    <span class="comment">//      -----------------+------+------+-------------+-------------+---  (B)</span></div>
<div class="line"><span class="lineno">17060</span>    <span class="comment">//                       v-     m-     v             m+            v+</span></div>
<div class="line"><span class="lineno">17061</span> </div>
<div class="line"><span class="lineno">17062</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> lower_boundary_is_closer = F == 0 &amp;&amp; E &gt; 1;</div>
<div class="line"><span class="lineno">17063</span>    <span class="keyword">const</span> diyfp m_plus = diyfp(2 * v.f + 1, v.e - 1);</div>
<div class="line"><span class="lineno">17064</span>    <span class="keyword">const</span> diyfp m_minus = lower_boundary_is_closer</div>
<div class="line"><span class="lineno">17065</span>                          ? diyfp(4 * v.f - 1, v.e - 2)  <span class="comment">// (B)</span></div>
<div class="line"><span class="lineno">17066</span>                          : diyfp(2 * v.f - 1, v.e - 1); <span class="comment">// (A)</span></div>
<div class="line"><span class="lineno">17067</span> </div>
<div class="line"><span class="lineno">17068</span>    <span class="comment">// Determine the normalized w+ = m+.</span></div>
<div class="line"><span class="lineno">17069</span>    <span class="keyword">const</span> diyfp w_plus = diyfp::normalize(m_plus);</div>
<div class="line"><span class="lineno">17070</span> </div>
<div class="line"><span class="lineno">17071</span>    <span class="comment">// Determine w- = m- such that e_(w-) = e_(w+).</span></div>
<div class="line"><span class="lineno">17072</span>    <span class="keyword">const</span> diyfp w_minus = diyfp::normalize_to(m_minus, w_plus.e);</div>
<div class="line"><span class="lineno">17073</span> </div>
<div class="line"><span class="lineno">17074</span>    <span class="keywordflow">return</span> {diyfp::normalize(v), w_minus, w_plus};</div>
<div class="line"><span class="lineno">17075</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a04eb234a28617519974fc962cd4da666" name="a04eb234a28617519974fc962cd4da666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04eb234a28617519974fc962cd4da666">&#9670;&#160;</a></span>find_largest_pow10()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int detail::dtoa_impl::find_largest_pow10 </td>
          <td>(</td>
          <td class="paramtype">const std::uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint32_t &amp;&#160;</td>
          <td class="paramname"><em>pow10</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>For n != 0, returns k, such that pow10 := 10^(k-1) &lt;= n &lt; 10^k. For n == 0, returns 1 and sets pow10 := 1. </p>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17313">17313</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17314</span>{</div>
<div class="line"><span class="lineno">17315</span>    <span class="comment">// LCOV_EXCL_START</span></div>
<div class="line"><span class="lineno">17316</span>    <span class="keywordflow">if</span> (n &gt;= 1000000000)</div>
<div class="line"><span class="lineno">17317</span>    {</div>
<div class="line"><span class="lineno">17318</span>        pow10 = 1000000000;</div>
<div class="line"><span class="lineno">17319</span>        <span class="keywordflow">return</span> 10;</div>
<div class="line"><span class="lineno">17320</span>    }</div>
<div class="line"><span class="lineno">17321</span>    <span class="comment">// LCOV_EXCL_STOP</span></div>
<div class="line"><span class="lineno">17322</span>    <span class="keywordflow">if</span> (n &gt;= 100000000)</div>
<div class="line"><span class="lineno">17323</span>    {</div>
<div class="line"><span class="lineno">17324</span>        pow10 = 100000000;</div>
<div class="line"><span class="lineno">17325</span>        <span class="keywordflow">return</span>  9;</div>
<div class="line"><span class="lineno">17326</span>    }</div>
<div class="line"><span class="lineno">17327</span>    <span class="keywordflow">if</span> (n &gt;= 10000000)</div>
<div class="line"><span class="lineno">17328</span>    {</div>
<div class="line"><span class="lineno">17329</span>        pow10 = 10000000;</div>
<div class="line"><span class="lineno">17330</span>        <span class="keywordflow">return</span>  8;</div>
<div class="line"><span class="lineno">17331</span>    }</div>
<div class="line"><span class="lineno">17332</span>    <span class="keywordflow">if</span> (n &gt;= 1000000)</div>
<div class="line"><span class="lineno">17333</span>    {</div>
<div class="line"><span class="lineno">17334</span>        pow10 = 1000000;</div>
<div class="line"><span class="lineno">17335</span>        <span class="keywordflow">return</span>  7;</div>
<div class="line"><span class="lineno">17336</span>    }</div>
<div class="line"><span class="lineno">17337</span>    <span class="keywordflow">if</span> (n &gt;= 100000)</div>
<div class="line"><span class="lineno">17338</span>    {</div>
<div class="line"><span class="lineno">17339</span>        pow10 = 100000;</div>
<div class="line"><span class="lineno">17340</span>        <span class="keywordflow">return</span>  6;</div>
<div class="line"><span class="lineno">17341</span>    }</div>
<div class="line"><span class="lineno">17342</span>    <span class="keywordflow">if</span> (n &gt;= 10000)</div>
<div class="line"><span class="lineno">17343</span>    {</div>
<div class="line"><span class="lineno">17344</span>        pow10 = 10000;</div>
<div class="line"><span class="lineno">17345</span>        <span class="keywordflow">return</span>  5;</div>
<div class="line"><span class="lineno">17346</span>    }</div>
<div class="line"><span class="lineno">17347</span>    <span class="keywordflow">if</span> (n &gt;= 1000)</div>
<div class="line"><span class="lineno">17348</span>    {</div>
<div class="line"><span class="lineno">17349</span>        pow10 = 1000;</div>
<div class="line"><span class="lineno">17350</span>        <span class="keywordflow">return</span>  4;</div>
<div class="line"><span class="lineno">17351</span>    }</div>
<div class="line"><span class="lineno">17352</span>    <span class="keywordflow">if</span> (n &gt;= 100)</div>
<div class="line"><span class="lineno">17353</span>    {</div>
<div class="line"><span class="lineno">17354</span>        pow10 = 100;</div>
<div class="line"><span class="lineno">17355</span>        <span class="keywordflow">return</span>  3;</div>
<div class="line"><span class="lineno">17356</span>    }</div>
<div class="line"><span class="lineno">17357</span>    <span class="keywordflow">if</span> (n &gt;= 10)</div>
<div class="line"><span class="lineno">17358</span>    {</div>
<div class="line"><span class="lineno">17359</span>        pow10 = 10;</div>
<div class="line"><span class="lineno">17360</span>        <span class="keywordflow">return</span>  2;</div>
<div class="line"><span class="lineno">17361</span>    }</div>
<div class="line"><span class="lineno">17362</span> </div>
<div class="line"><span class="lineno">17363</span>    pow10 = 1;</div>
<div class="line"><span class="lineno">17364</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">17365</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afab91abfdd1cdf43cc2fcd5b9c4a7456" name="afab91abfdd1cdf43cc2fcd5b9c4a7456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afab91abfdd1cdf43cc2fcd5b9c4a7456">&#9670;&#160;</a></span>format_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="json_8hpp.html#a5f2aaec3b681d0a72f7d6e90b70cdcd1">JSON_HEDLEY_RETURNS_NON_NULL</a> char * detail::dtoa_impl::format_buffer </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_exp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prettify v = buf * 10^decimal_exponent </p>
<p>If v is in the range [10^min_exp, 10^max_exp) it will be printed in fixed-point notation. Otherwise it will be printed in exponential notation.</p>
<dl class="section pre"><dt>Precondition</dt><dd>min_exp &lt; 0 </dd>
<dd>
max_exp &gt; 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17801">17801</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17803</span>{</div>
<div class="line"><span class="lineno">17804</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(min_exp &lt; 0);</div>
<div class="line"><span class="lineno">17805</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(max_exp &gt; 0);</div>
<div class="line"><span class="lineno">17806</span> </div>
<div class="line"><span class="lineno">17807</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> k = len;</div>
<div class="line"><span class="lineno">17808</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> n = len + decimal_exponent;</div>
<div class="line"><span class="lineno">17809</span> </div>
<div class="line"><span class="lineno">17810</span>    <span class="comment">// v = buf * 10^(n-k)</span></div>
<div class="line"><span class="lineno">17811</span>    <span class="comment">// k is the length of the buffer (number of decimal digits)</span></div>
<div class="line"><span class="lineno">17812</span>    <span class="comment">// n is the position of the decimal point relative to the start of the buffer.</span></div>
<div class="line"><span class="lineno">17813</span> </div>
<div class="line"><span class="lineno">17814</span>    <span class="keywordflow">if</span> (k &lt;= n &amp;&amp; n &lt;= max_exp)</div>
<div class="line"><span class="lineno">17815</span>    {</div>
<div class="line"><span class="lineno">17816</span>        <span class="comment">// digits[000]</span></div>
<div class="line"><span class="lineno">17817</span>        <span class="comment">// len &lt;= max_exp + 2</span></div>
<div class="line"><span class="lineno">17818</span> </div>
<div class="line"><span class="lineno">17819</span>        std::memset(buf + k, <span class="charliteral">&#39;0&#39;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(n) - <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k));</div>
<div class="line"><span class="lineno">17820</span>        <span class="comment">// Make it look like a floating-point number (#362, #378)</span></div>
<div class="line"><span class="lineno">17821</span>        buf[n + 0] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><span class="lineno">17822</span>        buf[n + 1] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><span class="lineno">17823</span>        <span class="keywordflow">return</span> buf + (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(n) + 2);</div>
<div class="line"><span class="lineno">17824</span>    }</div>
<div class="line"><span class="lineno">17825</span> </div>
<div class="line"><span class="lineno">17826</span>    <span class="keywordflow">if</span> (0 &lt; n &amp;&amp; n &lt;= max_exp)</div>
<div class="line"><span class="lineno">17827</span>    {</div>
<div class="line"><span class="lineno">17828</span>        <span class="comment">// dig.its</span></div>
<div class="line"><span class="lineno">17829</span>        <span class="comment">// len &lt;= max_digits10 + 1</span></div>
<div class="line"><span class="lineno">17830</span> </div>
<div class="line"><span class="lineno">17831</span>        <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(k &gt; n);</div>
<div class="line"><span class="lineno">17832</span> </div>
<div class="line"><span class="lineno">17833</span>        std::memmove(buf + (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(n) + 1), buf + n, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k) - <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(n));</div>
<div class="line"><span class="lineno">17834</span>        buf[n] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><span class="lineno">17835</span>        <span class="keywordflow">return</span> buf + (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k) + 1U);</div>
<div class="line"><span class="lineno">17836</span>    }</div>
<div class="line"><span class="lineno">17837</span> </div>
<div class="line"><span class="lineno">17838</span>    <span class="keywordflow">if</span> (min_exp &lt; n &amp;&amp; n &lt;= 0)</div>
<div class="line"><span class="lineno">17839</span>    {</div>
<div class="line"><span class="lineno">17840</span>        <span class="comment">// 0.[000]digits</span></div>
<div class="line"><span class="lineno">17841</span>        <span class="comment">// len &lt;= 2 + (-min_exp - 1) + max_digits10</span></div>
<div class="line"><span class="lineno">17842</span> </div>
<div class="line"><span class="lineno">17843</span>        std::memmove(buf + (2 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(-n)), buf, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k));</div>
<div class="line"><span class="lineno">17844</span>        buf[0] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><span class="lineno">17845</span>        buf[1] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><span class="lineno">17846</span>        std::memset(buf + 2, <span class="charliteral">&#39;0&#39;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(-n));</div>
<div class="line"><span class="lineno">17847</span>        <span class="keywordflow">return</span> buf + (2U + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(-n) + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k));</div>
<div class="line"><span class="lineno">17848</span>    }</div>
<div class="line"><span class="lineno">17849</span> </div>
<div class="line"><span class="lineno">17850</span>    <span class="keywordflow">if</span> (k == 1)</div>
<div class="line"><span class="lineno">17851</span>    {</div>
<div class="line"><span class="lineno">17852</span>        <span class="comment">// dE+123</span></div>
<div class="line"><span class="lineno">17853</span>        <span class="comment">// len &lt;= 1 + 5</span></div>
<div class="line"><span class="lineno">17854</span> </div>
<div class="line"><span class="lineno">17855</span>        buf += 1;</div>
<div class="line"><span class="lineno">17856</span>    }</div>
<div class="line"><span class="lineno">17857</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">17858</span>    {</div>
<div class="line"><span class="lineno">17859</span>        <span class="comment">// d.igitsE+123</span></div>
<div class="line"><span class="lineno">17860</span>        <span class="comment">// len &lt;= max_digits10 + 1 + 5</span></div>
<div class="line"><span class="lineno">17861</span> </div>
<div class="line"><span class="lineno">17862</span>        std::memmove(buf + 2, buf + 1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k) - 1);</div>
<div class="line"><span class="lineno">17863</span>        buf[1] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><span class="lineno">17864</span>        buf += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(k);</div>
<div class="line"><span class="lineno">17865</span>    }</div>
<div class="line"><span class="lineno">17866</span> </div>
<div class="line"><span class="lineno">17867</span>    *buf++ = <span class="charliteral">&#39;e&#39;</span>;</div>
<div class="line"><span class="lineno">17868</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#aec9f6655c3b629aeb0e8c887aea5da87">append_exponent</a>(buf, n - 1);</div>
<div class="line"><span class="lineno">17869</span>}</div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_aec9f6655c3b629aeb0e8c887aea5da87"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#aec9f6655c3b629aeb0e8c887aea5da87">detail::dtoa_impl::append_exponent</a></div><div class="ttdeci">JSON_HEDLEY_RETURNS_NON_NULL char * append_exponent(char *buf, int e)</div><div class="ttdoc">appends a decimal representation of e to buf</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17749">json.hpp:17749</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a29ae6574f6be09a5c8ab08da9a3f71b4" name="a29ae6574f6be09a5c8ab08da9a3f71b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29ae6574f6be09a5c8ab08da9a3f71b4">&#9670;&#160;</a></span>get_cached_power_for_binary_exponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdetail_1_1dtoa__impl_1_1cached__power.html">cached_power</a> detail::dtoa_impl::get_cached_power_for_binary_exponent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>For a normalized diyfp w = f * 2^e, this function returns a (normalized) cached power-of-ten c = f_c * 2^e_c, such that the exponent of the product w * c satisfies (Definition 3.2 from [1]) </p><pre class="fragment"> alpha &lt;= e_c + e + q &lt;= gamma.
</pre> 
<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17149">17149</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17150</span>{</div>
<div class="line"><span class="lineno">17151</span>    <span class="comment">// Now</span></div>
<div class="line"><span class="lineno">17152</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17153</span>    <span class="comment">//      alpha &lt;= e_c + e + q &lt;= gamma                                    (1)</span></div>
<div class="line"><span class="lineno">17154</span>    <span class="comment">//      ==&gt; f_c * 2^alpha &lt;= c * 2^e * 2^q</span></div>
<div class="line"><span class="lineno">17155</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17156</span>    <span class="comment">// and since the c&#39;s are normalized, 2^(q-1) &lt;= f_c,</span></div>
<div class="line"><span class="lineno">17157</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17158</span>    <span class="comment">//      ==&gt; 2^(q - 1 + alpha) &lt;= c * 2^(e + q)</span></div>
<div class="line"><span class="lineno">17159</span>    <span class="comment">//      ==&gt; 2^(alpha - e - 1) &lt;= c</span></div>
<div class="line"><span class="lineno">17160</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17161</span>    <span class="comment">// If c were an exact power of ten, i.e. c = 10^k, one may determine k as</span></div>
<div class="line"><span class="lineno">17162</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17163</span>    <span class="comment">//      k = ceil( log_10( 2^(alpha - e - 1) ) )</span></div>
<div class="line"><span class="lineno">17164</span>    <span class="comment">//        = ceil( (alpha - e - 1) * log_10(2) )</span></div>
<div class="line"><span class="lineno">17165</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17166</span>    <span class="comment">// From the paper:</span></div>
<div class="line"><span class="lineno">17167</span>    <span class="comment">// &quot;In theory the result of the procedure could be wrong since c is rounded,</span></div>
<div class="line"><span class="lineno">17168</span>    <span class="comment">//  and the computation itself is approximated [...]. In practice, however,</span></div>
<div class="line"><span class="lineno">17169</span>    <span class="comment">//  this simple function is sufficient.&quot;</span></div>
<div class="line"><span class="lineno">17170</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17171</span>    <span class="comment">// For IEEE double precision floating-point numbers converted into</span></div>
<div class="line"><span class="lineno">17172</span>    <span class="comment">// normalized diyfp&#39;s w = f * 2^e, with q = 64,</span></div>
<div class="line"><span class="lineno">17173</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17174</span>    <span class="comment">//      e &gt;= -1022      (min IEEE exponent)</span></div>
<div class="line"><span class="lineno">17175</span>    <span class="comment">//           -52        (p - 1)</span></div>
<div class="line"><span class="lineno">17176</span>    <span class="comment">//           -52        (p - 1, possibly normalize denormal IEEE numbers)</span></div>
<div class="line"><span class="lineno">17177</span>    <span class="comment">//           -11        (normalize the diyfp)</span></div>
<div class="line"><span class="lineno">17178</span>    <span class="comment">//         = -1137</span></div>
<div class="line"><span class="lineno">17179</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17180</span>    <span class="comment">// and</span></div>
<div class="line"><span class="lineno">17181</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17182</span>    <span class="comment">//      e &lt;= +1023      (max IEEE exponent)</span></div>
<div class="line"><span class="lineno">17183</span>    <span class="comment">//           -52        (p - 1)</span></div>
<div class="line"><span class="lineno">17184</span>    <span class="comment">//           -11        (normalize the diyfp)</span></div>
<div class="line"><span class="lineno">17185</span>    <span class="comment">//         = 960</span></div>
<div class="line"><span class="lineno">17186</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17187</span>    <span class="comment">// This binary exponent range [-1137,960] results in a decimal exponent</span></div>
<div class="line"><span class="lineno">17188</span>    <span class="comment">// range [-307,324]. One does not need to store a cached power for each</span></div>
<div class="line"><span class="lineno">17189</span>    <span class="comment">// k in this range. For each such k it suffices to find a cached power</span></div>
<div class="line"><span class="lineno">17190</span>    <span class="comment">// such that the exponent of the product lies in [alpha,gamma].</span></div>
<div class="line"><span class="lineno">17191</span>    <span class="comment">// This implies that the difference of the decimal exponents of adjacent</span></div>
<div class="line"><span class="lineno">17192</span>    <span class="comment">// table entries must be less than or equal to</span></div>
<div class="line"><span class="lineno">17193</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17194</span>    <span class="comment">//      floor( (gamma - alpha) * log_10(2) ) = 8.</span></div>
<div class="line"><span class="lineno">17195</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17196</span>    <span class="comment">// (A smaller distance gamma-alpha would require a larger table.)</span></div>
<div class="line"><span class="lineno">17197</span> </div>
<div class="line"><span class="lineno">17198</span>    <span class="comment">// NB:</span></div>
<div class="line"><span class="lineno">17199</span>    <span class="comment">// Actually this function returns c, such that -60 &lt;= e_c + e + 64 &lt;= -34.</span></div>
<div class="line"><span class="lineno">17200</span> </div>
<div class="line"><span class="lineno">17201</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kCachedPowersMinDecExp = -300;</div>
<div class="line"><span class="lineno">17202</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kCachedPowersDecStep = 8;</div>
<div class="line"><span class="lineno">17203</span> </div>
<div class="line"><span class="lineno">17204</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> std::array&lt;cached_power, 79&gt; kCachedPowers =</div>
<div class="line"><span class="lineno">17205</span>    {</div>
<div class="line"><span class="lineno">17206</span>        {</div>
<div class="line"><span class="lineno">17207</span>            { 0xAB70FE17C79AC6CA, -1060, -300 },</div>
<div class="line"><span class="lineno">17208</span>            { 0xFF77B1FCBEBCDC4F, -1034, -292 },</div>
<div class="line"><span class="lineno">17209</span>            { 0xBE5691EF416BD60C, -1007, -284 },</div>
<div class="line"><span class="lineno">17210</span>            { 0x8DD01FAD907FFC3C,  -980, -276 },</div>
<div class="line"><span class="lineno">17211</span>            { 0xD3515C2831559A83,  -954, -268 },</div>
<div class="line"><span class="lineno">17212</span>            { 0x9D71AC8FADA6C9B5,  -927, -260 },</div>
<div class="line"><span class="lineno">17213</span>            { 0xEA9C227723EE8BCB,  -901, -252 },</div>
<div class="line"><span class="lineno">17214</span>            { 0xAECC49914078536D,  -874, -244 },</div>
<div class="line"><span class="lineno">17215</span>            { 0x823C12795DB6CE57,  -847, -236 },</div>
<div class="line"><span class="lineno">17216</span>            { 0xC21094364DFB5637,  -821, -228 },</div>
<div class="line"><span class="lineno">17217</span>            { 0x9096EA6F3848984F,  -794, -220 },</div>
<div class="line"><span class="lineno">17218</span>            { 0xD77485CB25823AC7,  -768, -212 },</div>
<div class="line"><span class="lineno">17219</span>            { 0xA086CFCD97BF97F4,  -741, -204 },</div>
<div class="line"><span class="lineno">17220</span>            { 0xEF340A98172AACE5,  -715, -196 },</div>
<div class="line"><span class="lineno">17221</span>            { 0xB23867FB2A35B28E,  -688, -188 },</div>
<div class="line"><span class="lineno">17222</span>            { 0x84C8D4DFD2C63F3B,  -661, -180 },</div>
<div class="line"><span class="lineno">17223</span>            { 0xC5DD44271AD3CDBA,  -635, -172 },</div>
<div class="line"><span class="lineno">17224</span>            { 0x936B9FCEBB25C996,  -608, -164 },</div>
<div class="line"><span class="lineno">17225</span>            { 0xDBAC6C247D62A584,  -582, -156 },</div>
<div class="line"><span class="lineno">17226</span>            { 0xA3AB66580D5FDAF6,  -555, -148 },</div>
<div class="line"><span class="lineno">17227</span>            { 0xF3E2F893DEC3F126,  -529, -140 },</div>
<div class="line"><span class="lineno">17228</span>            { 0xB5B5ADA8AAFF80B8,  -502, -132 },</div>
<div class="line"><span class="lineno">17229</span>            { 0x87625F056C7C4A8B,  -475, -124 },</div>
<div class="line"><span class="lineno">17230</span>            { 0xC9BCFF6034C13053,  -449, -116 },</div>
<div class="line"><span class="lineno">17231</span>            { 0x964E858C91BA2655,  -422, -108 },</div>
<div class="line"><span class="lineno">17232</span>            { 0xDFF9772470297EBD,  -396, -100 },</div>
<div class="line"><span class="lineno">17233</span>            { 0xA6DFBD9FB8E5B88F,  -369,  -92 },</div>
<div class="line"><span class="lineno">17234</span>            { 0xF8A95FCF88747D94,  -343,  -84 },</div>
<div class="line"><span class="lineno">17235</span>            { 0xB94470938FA89BCF,  -316,  -76 },</div>
<div class="line"><span class="lineno">17236</span>            { 0x8A08F0F8BF0F156B,  -289,  -68 },</div>
<div class="line"><span class="lineno">17237</span>            { 0xCDB02555653131B6,  -263,  -60 },</div>
<div class="line"><span class="lineno">17238</span>            { 0x993FE2C6D07B7FAC,  -236,  -52 },</div>
<div class="line"><span class="lineno">17239</span>            { 0xE45C10C42A2B3B06,  -210,  -44 },</div>
<div class="line"><span class="lineno">17240</span>            { 0xAA242499697392D3,  -183,  -36 },</div>
<div class="line"><span class="lineno">17241</span>            { 0xFD87B5F28300CA0E,  -157,  -28 },</div>
<div class="line"><span class="lineno">17242</span>            { 0xBCE5086492111AEB,  -130,  -20 },</div>
<div class="line"><span class="lineno">17243</span>            { 0x8CBCCC096F5088CC,  -103,  -12 },</div>
<div class="line"><span class="lineno">17244</span>            { 0xD1B71758E219652C,   -77,   -4 },</div>
<div class="line"><span class="lineno">17245</span>            { 0x9C40000000000000,   -50,    4 },</div>
<div class="line"><span class="lineno">17246</span>            { 0xE8D4A51000000000,   -24,   12 },</div>
<div class="line"><span class="lineno">17247</span>            { 0xAD78EBC5AC620000,     3,   20 },</div>
<div class="line"><span class="lineno">17248</span>            { 0x813F3978F8940984,    30,   28 },</div>
<div class="line"><span class="lineno">17249</span>            { 0xC097CE7BC90715B3,    56,   36 },</div>
<div class="line"><span class="lineno">17250</span>            { 0x8F7E32CE7BEA5C70,    83,   44 },</div>
<div class="line"><span class="lineno">17251</span>            { 0xD5D238A4ABE98068,   109,   52 },</div>
<div class="line"><span class="lineno">17252</span>            { 0x9F4F2726179A2245,   136,   60 },</div>
<div class="line"><span class="lineno">17253</span>            { 0xED63A231D4C4FB27,   162,   68 },</div>
<div class="line"><span class="lineno">17254</span>            { 0xB0DE65388CC8ADA8,   189,   76 },</div>
<div class="line"><span class="lineno">17255</span>            { 0x83C7088E1AAB65DB,   216,   84 },</div>
<div class="line"><span class="lineno">17256</span>            { 0xC45D1DF942711D9A,   242,   92 },</div>
<div class="line"><span class="lineno">17257</span>            { 0x924D692CA61BE758,   269,  100 },</div>
<div class="line"><span class="lineno">17258</span>            { 0xDA01EE641A708DEA,   295,  108 },</div>
<div class="line"><span class="lineno">17259</span>            { 0xA26DA3999AEF774A,   322,  116 },</div>
<div class="line"><span class="lineno">17260</span>            { 0xF209787BB47D6B85,   348,  124 },</div>
<div class="line"><span class="lineno">17261</span>            { 0xB454E4A179DD1877,   375,  132 },</div>
<div class="line"><span class="lineno">17262</span>            { 0x865B86925B9BC5C2,   402,  140 },</div>
<div class="line"><span class="lineno">17263</span>            { 0xC83553C5C8965D3D,   428,  148 },</div>
<div class="line"><span class="lineno">17264</span>            { 0x952AB45CFA97A0B3,   455,  156 },</div>
<div class="line"><span class="lineno">17265</span>            { 0xDE469FBD99A05FE3,   481,  164 },</div>
<div class="line"><span class="lineno">17266</span>            { 0xA59BC234DB398C25,   508,  172 },</div>
<div class="line"><span class="lineno">17267</span>            { 0xF6C69A72A3989F5C,   534,  180 },</div>
<div class="line"><span class="lineno">17268</span>            { 0xB7DCBF5354E9BECE,   561,  188 },</div>
<div class="line"><span class="lineno">17269</span>            { 0x88FCF317F22241E2,   588,  196 },</div>
<div class="line"><span class="lineno">17270</span>            { 0xCC20CE9BD35C78A5,   614,  204 },</div>
<div class="line"><span class="lineno">17271</span>            { 0x98165AF37B2153DF,   641,  212 },</div>
<div class="line"><span class="lineno">17272</span>            { 0xE2A0B5DC971F303A,   667,  220 },</div>
<div class="line"><span class="lineno">17273</span>            { 0xA8D9D1535CE3B396,   694,  228 },</div>
<div class="line"><span class="lineno">17274</span>            { 0xFB9B7CD9A4A7443C,   720,  236 },</div>
<div class="line"><span class="lineno">17275</span>            { 0xBB764C4CA7A44410,   747,  244 },</div>
<div class="line"><span class="lineno">17276</span>            { 0x8BAB8EEFB6409C1A,   774,  252 },</div>
<div class="line"><span class="lineno">17277</span>            { 0xD01FEF10A657842C,   800,  260 },</div>
<div class="line"><span class="lineno">17278</span>            { 0x9B10A4E5E9913129,   827,  268 },</div>
<div class="line"><span class="lineno">17279</span>            { 0xE7109BFBA19C0C9D,   853,  276 },</div>
<div class="line"><span class="lineno">17280</span>            { 0xAC2820D9623BF429,   880,  284 },</div>
<div class="line"><span class="lineno">17281</span>            { 0x80444B5E7AA7CF85,   907,  292 },</div>
<div class="line"><span class="lineno">17282</span>            { 0xBF21E44003ACDD2D,   933,  300 },</div>
<div class="line"><span class="lineno">17283</span>            { 0x8E679C2F5E44FF8F,   960,  308 },</div>
<div class="line"><span class="lineno">17284</span>            { 0xD433179D9C8CB841,   986,  316 },</div>
<div class="line"><span class="lineno">17285</span>            { 0x9E19DB92B4E31BA9,  1013,  324 },</div>
<div class="line"><span class="lineno">17286</span>        }</div>
<div class="line"><span class="lineno">17287</span>    };</div>
<div class="line"><span class="lineno">17288</span> </div>
<div class="line"><span class="lineno">17289</span>    <span class="comment">// This computation gives exactly the same results for k as</span></div>
<div class="line"><span class="lineno">17290</span>    <span class="comment">//      k = ceil((kAlpha - e - 1) * 0.30102999566398114)</span></div>
<div class="line"><span class="lineno">17291</span>    <span class="comment">// for |e| &lt;= 1500, but doesn&#39;t require floating-point operations.</span></div>
<div class="line"><span class="lineno">17292</span>    <span class="comment">// NB: log_10(2) ~= 78913 / 2^18</span></div>
<div class="line"><span class="lineno">17293</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(e &gt;= -1500);</div>
<div class="line"><span class="lineno">17294</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(e &lt;=  1500);</div>
<div class="line"><span class="lineno">17295</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> f = <a class="code hl_variable" href="namespacedetail_1_1dtoa__impl.html#a95c569b7627a9372686f1f77d73e8660">kAlpha</a> - e - 1;</div>
<div class="line"><span class="lineno">17296</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> k = (f * 78913) / (1 &lt;&lt; 18) + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(f &gt; 0);</div>
<div class="line"><span class="lineno">17297</span> </div>
<div class="line"><span class="lineno">17298</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> index = (-kCachedPowersMinDecExp + k + (kCachedPowersDecStep - 1)) / kCachedPowersDecStep;</div>
<div class="line"><span class="lineno">17299</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(index &gt;= 0);</div>
<div class="line"><span class="lineno">17300</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(index) &lt; kCachedPowers.size());</div>
<div class="line"><span class="lineno">17301</span> </div>
<div class="line"><span class="lineno">17302</span>    <span class="keyword">const</span> cached_power cached = kCachedPowers[<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(index)];</div>
<div class="line"><span class="lineno">17303</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(kAlpha &lt;= cached.e + e + 64);</div>
<div class="line"><span class="lineno">17304</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(kGamma &gt;= cached.e + e + 64);</div>
<div class="line"><span class="lineno">17305</span> </div>
<div class="line"><span class="lineno">17306</span>    <span class="keywordflow">return</span> cached;</div>
<div class="line"><span class="lineno">17307</span>}</div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_a95c569b7627a9372686f1f77d73e8660"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#a95c569b7627a9372686f1f77d73e8660">detail::dtoa_impl::kAlpha</a></div><div class="ttdeci">constexpr int kAlpha</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17132">json.hpp:17132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad549352ed1a9676a092d143a2daa3dee" name="ad549352ed1a9676a092d143a2daa3dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad549352ed1a9676a092d143a2daa3dee">&#9670;&#160;</a></span>grisu2() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void detail::dtoa_impl::grisu2 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>m_minus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>m_plus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>v = buf * 10^decimal_exponent len is the length of the buffer (number of decimal digits) The buffer must be large enough, i.e. &gt;= max_digits10. </p>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17649">17649</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17651</span>{</div>
<div class="line"><span class="lineno">17652</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(m_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a> == m_minus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>);</div>
<div class="line"><span class="lineno">17653</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(m_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a> == v.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>);</div>
<div class="line"><span class="lineno">17654</span> </div>
<div class="line"><span class="lineno">17655</span>    <span class="comment">//  --------(-----------------------+-----------------------)--------    (A)</span></div>
<div class="line"><span class="lineno">17656</span>    <span class="comment">//          m-                      v                       m+</span></div>
<div class="line"><span class="lineno">17657</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17658</span>    <span class="comment">//  --------------------(-----------+-----------------------)--------    (B)</span></div>
<div class="line"><span class="lineno">17659</span>    <span class="comment">//                      m-          v                       m+</span></div>
<div class="line"><span class="lineno">17660</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17661</span>    <span class="comment">// First scale v (and m- and m+) such that the exponent is in the range</span></div>
<div class="line"><span class="lineno">17662</span>    <span class="comment">// [alpha, gamma].</span></div>
<div class="line"><span class="lineno">17663</span> </div>
<div class="line"><span class="lineno">17664</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1cached__power.html">cached_power</a> cached = <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#a29ae6574f6be09a5c8ab08da9a3f71b4">get_cached_power_for_binary_exponent</a>(m_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>);</div>
<div class="line"><span class="lineno">17665</span> </div>
<div class="line"><span class="lineno">17666</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> c_minus_k(cached.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1cached__power.html#a1e1bc1d228d8e54dc830fe6ef719eecf">f</a>, cached.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1cached__power.html#a96cc75e988a7e08e2de93db20024e7df">e</a>); <span class="comment">// = c ~= 10^-k</span></div>
<div class="line"><span class="lineno">17667</span> </div>
<div class="line"><span class="lineno">17668</span>    <span class="comment">// The exponent of the products is = v.e + c_minus_k.e + q and is in the range [alpha,gamma]</span></div>
<div class="line"><span class="lineno">17669</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> w       = diyfp::mul(v,       c_minus_k);</div>
<div class="line"><span class="lineno">17670</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> w_minus = diyfp::mul(m_minus, c_minus_k);</div>
<div class="line"><span class="lineno">17671</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> w_plus  = diyfp::mul(m_plus,  c_minus_k);</div>
<div class="line"><span class="lineno">17672</span> </div>
<div class="line"><span class="lineno">17673</span>    <span class="comment">//  ----(---+---)---------------(---+---)---------------(---+---)----</span></div>
<div class="line"><span class="lineno">17674</span>    <span class="comment">//          w-                      w                       w+</span></div>
<div class="line"><span class="lineno">17675</span>    <span class="comment">//          = c*m-                  = c*v                   = c*m+</span></div>
<div class="line"><span class="lineno">17676</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17677</span>    <span class="comment">// diyfp::mul rounds its result and c_minus_k is approximated too. w, w- and</span></div>
<div class="line"><span class="lineno">17678</span>    <span class="comment">// w+ are now off by a small amount.</span></div>
<div class="line"><span class="lineno">17679</span>    <span class="comment">// In fact:</span></div>
<div class="line"><span class="lineno">17680</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17681</span>    <span class="comment">//      w - v * 10^k &lt; 1 ulp</span></div>
<div class="line"><span class="lineno">17682</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17683</span>    <span class="comment">// To account for this inaccuracy, add resp. subtract 1 ulp.</span></div>
<div class="line"><span class="lineno">17684</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17685</span>    <span class="comment">//  --------+---[---------------(---+---)---------------]---+--------</span></div>
<div class="line"><span class="lineno">17686</span>    <span class="comment">//          w-  M-                  w                   M+  w+</span></div>
<div class="line"><span class="lineno">17687</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17688</span>    <span class="comment">// Now any number in [M-, M+] (bounds included) will round to w when input,</span></div>
<div class="line"><span class="lineno">17689</span>    <span class="comment">// regardless of how the input rounding algorithm breaks ties.</span></div>
<div class="line"><span class="lineno">17690</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17691</span>    <span class="comment">// And digit_gen generates the shortest possible such number in [M-, M+].</span></div>
<div class="line"><span class="lineno">17692</span>    <span class="comment">// Note that this does not mean that Grisu2 always generates the shortest</span></div>
<div class="line"><span class="lineno">17693</span>    <span class="comment">// possible number in the interval (m-, m+).</span></div>
<div class="line"><span class="lineno">17694</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_minus(w_minus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae1518119517cb69d79aa64ffb93c8375">f</a> + 1, w_minus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>);</div>
<div class="line"><span class="lineno">17695</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_plus (w_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae1518119517cb69d79aa64ffb93c8375">f</a>  - 1, w_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a> );</div>
<div class="line"><span class="lineno">17696</span> </div>
<div class="line"><span class="lineno">17697</span>    decimal_exponent = -cached.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1cached__power.html#ae9c889d5fc4427f633ec23044e986755">k</a>; <span class="comment">// = -(-k) = k</span></div>
<div class="line"><span class="lineno">17698</span> </div>
<div class="line"><span class="lineno">17699</span>    <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#ae877aa13ab872c99a1c614e5e1524807">grisu2_digit_gen</a>(buf, len, decimal_exponent, M_minus, w, M_plus);</div>
<div class="line"><span class="lineno">17700</span>}</div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_a29ae6574f6be09a5c8ab08da9a3f71b4"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#a29ae6574f6be09a5c8ab08da9a3f71b4">detail::dtoa_impl::get_cached_power_for_binary_exponent</a></div><div class="ttdeci">cached_power get_cached_power_for_binary_exponent(int e)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17149">json.hpp:17149</a></div></div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_ae877aa13ab872c99a1c614e5e1524807"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#ae877aa13ab872c99a1c614e5e1524807">detail::dtoa_impl::grisu2_digit_gen</a></div><div class="ttdeci">void grisu2_digit_gen(char *buffer, int &amp;length, int &amp;decimal_exponent, diyfp M_minus, diyfp w, diyfp M_plus)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17408">json.hpp:17408</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1cached__power_html"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1cached__power.html">detail::dtoa_impl::cached_power</a></div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17135">json.hpp:17136</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1cached__power_html_a1e1bc1d228d8e54dc830fe6ef719eecf"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1cached__power.html#a1e1bc1d228d8e54dc830fe6ef719eecf">detail::dtoa_impl::cached_power::f</a></div><div class="ttdeci">std::uint64_t f</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17137">json.hpp:17137</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1cached__power_html_a96cc75e988a7e08e2de93db20024e7df"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1cached__power.html#a96cc75e988a7e08e2de93db20024e7df">detail::dtoa_impl::cached_power::e</a></div><div class="ttdeci">int e</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17138">json.hpp:17138</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1cached__power_html_ae9c889d5fc4427f633ec23044e986755"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1cached__power.html#ae9c889d5fc4427f633ec23044e986755">detail::dtoa_impl::cached_power::k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17139">json.hpp:17139</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1diyfp_html"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1diyfp.html">detail::dtoa_impl::diyfp</a></div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16878">json.hpp:16879</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1diyfp_html_ae1518119517cb69d79aa64ffb93c8375"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae1518119517cb69d79aa64ffb93c8375">detail::dtoa_impl::diyfp::f</a></div><div class="ttdeci">std::uint64_t f</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16882">json.hpp:16882</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1diyfp_html_ae2b59fab8dee9ef0192eb6b568fa7314"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">detail::dtoa_impl::diyfp::e</a></div><div class="ttdeci">int e</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16883">json.hpp:16883</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdf6bc05c54068a5930f66c2e803e8b8" name="abdf6bc05c54068a5930f66c2e803e8b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdf6bc05c54068a5930f66c2e803e8b8">&#9670;&#160;</a></span>grisu2() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename FloatType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void detail::dtoa_impl::grisu2 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FloatType&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v = buf * 10^decimal_exponent len is the length of the buffer (number of decimal digits) The buffer must be large enough, i.e. &gt;= max_digits10. </p>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17709">17709</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17710</span>{</div>
<div class="line"><span class="lineno">17711</span>    <span class="keyword">static_assert</span>(diyfp::kPrecision &gt;= std::numeric_limits&lt;FloatType&gt;::digits + 3,</div>
<div class="line"><span class="lineno">17712</span>                  <span class="stringliteral">&quot;internal error: not enough precision&quot;</span>);</div>
<div class="line"><span class="lineno">17713</span> </div>
<div class="line"><span class="lineno">17714</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(std::isfinite(value));</div>
<div class="line"><span class="lineno">17715</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(value &gt; 0);</div>
<div class="line"><span class="lineno">17716</span> </div>
<div class="line"><span class="lineno">17717</span>    <span class="comment">// If the neighbors (and boundaries) of &#39;value&#39; are always computed for double-precision</span></div>
<div class="line"><span class="lineno">17718</span>    <span class="comment">// numbers, all float&#39;s can be recovered using strtod (and strtof). However, the resulting</span></div>
<div class="line"><span class="lineno">17719</span>    <span class="comment">// decimal representations are not exactly &quot;short&quot;.</span></div>
<div class="line"><span class="lineno">17720</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17721</span>    <span class="comment">// The documentation for &#39;std::to_chars&#39; (https://en.cppreference.com/w/cpp/utility/to_chars)</span></div>
<div class="line"><span class="lineno">17722</span>    <span class="comment">// says &quot;value is converted to a string as if by std::sprintf in the default (&quot;C&quot;) locale&quot;</span></div>
<div class="line"><span class="lineno">17723</span>    <span class="comment">// and since sprintf promotes floats to doubles, I think this is exactly what &#39;std::to_chars&#39;</span></div>
<div class="line"><span class="lineno">17724</span>    <span class="comment">// does.</span></div>
<div class="line"><span class="lineno">17725</span>    <span class="comment">// On the other hand, the documentation for &#39;std::to_chars&#39; requires that &quot;parsing the</span></div>
<div class="line"><span class="lineno">17726</span>    <span class="comment">// representation using the corresponding std::from_chars function recovers value exactly&quot;. That</span></div>
<div class="line"><span class="lineno">17727</span>    <span class="comment">// indicates that single precision floating-point numbers should be recovered using</span></div>
<div class="line"><span class="lineno">17728</span>    <span class="comment">// &#39;std::strtof&#39;.</span></div>
<div class="line"><span class="lineno">17729</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17730</span>    <span class="comment">// NB: If the neighbors are computed for single-precision numbers, there is a single float</span></div>
<div class="line"><span class="lineno">17731</span>    <span class="comment">//     (7.0385307e-26f) which can&#39;t be recovered using strtod. The resulting double precision</span></div>
<div class="line"><span class="lineno">17732</span>    <span class="comment">//     value is off by 1 ulp.</span></div>
<div class="line"><span class="lineno">17733</span><span class="preprocessor">#if 0 </span><span class="comment">// NOLINT(readability-avoid-unconditional-preprocessor-if)</span></div>
<div class="line"><span class="lineno">17734</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1boundaries.html">boundaries</a> w = <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#a6a5ccf11847aab7a0f42f587b33935df">compute_boundaries</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value));</div>
<div class="line"><span class="lineno">17735</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">17736</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1boundaries.html">boundaries</a> w = <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#a6a5ccf11847aab7a0f42f587b33935df">compute_boundaries</a>(value);</div>
<div class="line"><span class="lineno">17737</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">17738</span> </div>
<div class="line"><span class="lineno">17739</span>    <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#ad549352ed1a9676a092d143a2daa3dee">grisu2</a>(buf, len, decimal_exponent, w.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1boundaries.html#aa3b1c7a566175a9ca2f23875dbbbccc4">minus</a>, w.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1boundaries.html#a4ca4291f3ebf758a4708698688dda485">w</a>, w.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1boundaries.html#ae2d4dbee09b23c49dac2980e8f455d08">plus</a>);</div>
<div class="line"><span class="lineno">17740</span>}</div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_a6a5ccf11847aab7a0f42f587b33935df"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#a6a5ccf11847aab7a0f42f587b33935df">detail::dtoa_impl::compute_boundaries</a></div><div class="ttdeci">boundaries compute_boundaries(FloatType value)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17010">json.hpp:17010</a></div></div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_ad549352ed1a9676a092d143a2daa3dee"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#ad549352ed1a9676a092d143a2daa3dee">detail::dtoa_impl::grisu2</a></div><div class="ttdeci">void grisu2(char *buf, int &amp;len, int &amp;decimal_exponent, diyfp m_minus, diyfp v, diyfp m_plus)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17649">json.hpp:17649</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1boundaries_html"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1boundaries.html">detail::dtoa_impl::boundaries</a></div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16996">json.hpp:16997</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1boundaries_html_a4ca4291f3ebf758a4708698688dda485"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1boundaries.html#a4ca4291f3ebf758a4708698688dda485">detail::dtoa_impl::boundaries::w</a></div><div class="ttdeci">diyfp w</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16998">json.hpp:16998</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1boundaries_html_aa3b1c7a566175a9ca2f23875dbbbccc4"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1boundaries.html#aa3b1c7a566175a9ca2f23875dbbbccc4">detail::dtoa_impl::boundaries::minus</a></div><div class="ttdeci">diyfp minus</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l16999">json.hpp:16999</a></div></div>
<div class="ttc" id="astructdetail_1_1dtoa__impl_1_1boundaries_html_ae2d4dbee09b23c49dac2980e8f455d08"><div class="ttname"><a href="structdetail_1_1dtoa__impl_1_1boundaries.html#ae2d4dbee09b23c49dac2980e8f455d08">detail::dtoa_impl::boundaries::plus</a></div><div class="ttdeci">diyfp plus</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17000">json.hpp:17000</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae877aa13ab872c99a1c614e5e1524807" name="ae877aa13ab872c99a1c614e5e1524807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae877aa13ab872c99a1c614e5e1524807">&#9670;&#160;</a></span>grisu2_digit_gen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void detail::dtoa_impl::grisu2_digit_gen </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>M_minus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a>&#160;</td>
          <td class="paramname"><em>M_plus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates V = buffer * 10^decimal_exponent, such that M- &lt;= V &lt;= M+. M- and M+ must be normalized and share the same exponent -60 &lt;= e &lt;= -32. </p>

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17408">17408</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17410</span>{</div>
<div class="line"><span class="lineno">17411</span>    <span class="keyword">static_assert</span>(<a class="code hl_variable" href="namespacedetail_1_1dtoa__impl.html#a95c569b7627a9372686f1f77d73e8660">kAlpha</a> &gt;= -60, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><span class="lineno">17412</span>    <span class="keyword">static_assert</span>(<a class="code hl_variable" href="namespacedetail_1_1dtoa__impl.html#ae152a095d2dd1a6dd41ef8ad39c26e19">kGamma</a> &lt;= -32, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><span class="lineno">17413</span> </div>
<div class="line"><span class="lineno">17414</span>    <span class="comment">// Generates the digits (and the exponent) of a decimal floating-point</span></div>
<div class="line"><span class="lineno">17415</span>    <span class="comment">// number V = buffer * 10^decimal_exponent in the range [M-, M+]. The diyfp&#39;s</span></div>
<div class="line"><span class="lineno">17416</span>    <span class="comment">// w, M- and M+ share the same exponent e, which satisfies alpha &lt;= e &lt;= gamma.</span></div>
<div class="line"><span class="lineno">17417</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17418</span>    <span class="comment">//               &lt;--------------------------- delta ----&gt;</span></div>
<div class="line"><span class="lineno">17419</span>    <span class="comment">//                                  &lt;---- dist ---------&gt;</span></div>
<div class="line"><span class="lineno">17420</span>    <span class="comment">// --------------[------------------+-------------------]--------------</span></div>
<div class="line"><span class="lineno">17421</span>    <span class="comment">//               M-                 w                   M+</span></div>
<div class="line"><span class="lineno">17422</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17423</span>    <span class="comment">// Grisu2 generates the digits of M+ from left to right and stops as soon as</span></div>
<div class="line"><span class="lineno">17424</span>    <span class="comment">// V is in [M-,M+].</span></div>
<div class="line"><span class="lineno">17425</span> </div>
<div class="line"><span class="lineno">17426</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a> &gt;= kAlpha);</div>
<div class="line"><span class="lineno">17427</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a> &lt;= kGamma);</div>
<div class="line"><span class="lineno">17428</span> </div>
<div class="line"><span class="lineno">17429</span>    std::uint64_t delta = diyfp::sub(M_plus, M_minus).f; <span class="comment">// (significand of (M+ - M-), implicit exponent is e)</span></div>
<div class="line"><span class="lineno">17430</span>    std::uint64_t dist  = diyfp::sub(M_plus, w      ).f; <span class="comment">// (significand of (M+ - w ), implicit exponent is e)</span></div>
<div class="line"><span class="lineno">17431</span> </div>
<div class="line"><span class="lineno">17432</span>    <span class="comment">// Split M+ = f * 2^e into two parts p1 and p2 (note: e &lt; 0):</span></div>
<div class="line"><span class="lineno">17433</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17434</span>    <span class="comment">//      M+ = f * 2^e</span></div>
<div class="line"><span class="lineno">17435</span>    <span class="comment">//         = ((f div 2^-e) * 2^-e + (f mod 2^-e)) * 2^e</span></div>
<div class="line"><span class="lineno">17436</span>    <span class="comment">//         = ((p1        ) * 2^-e + (p2        )) * 2^e</span></div>
<div class="line"><span class="lineno">17437</span>    <span class="comment">//         = p1 + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17438</span> </div>
<div class="line"><span class="lineno">17439</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structdetail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> one(std::uint64_t{1} &lt;&lt; -M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>, M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae2b59fab8dee9ef0192eb6b568fa7314">e</a>);</div>
<div class="line"><span class="lineno">17440</span> </div>
<div class="line"><span class="lineno">17441</span>    <span class="keyword">auto</span> p1 = <span class="keyword">static_cast&lt;</span>std::uint32_t<span class="keyword">&gt;</span>(M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae1518119517cb69d79aa64ffb93c8375">f</a> &gt;&gt; -one.e); <span class="comment">// p1 = f div 2^-e (Since -e &gt;= 32, p1 fits into a 32-bit int.)</span></div>
<div class="line"><span class="lineno">17442</span>    std::uint64_t p2 = M_plus.<a class="code hl_variable" href="structdetail_1_1dtoa__impl_1_1diyfp.html#ae1518119517cb69d79aa64ffb93c8375">f</a> &amp; (one.f - 1);                    <span class="comment">// p2 = f mod 2^-e</span></div>
<div class="line"><span class="lineno">17443</span> </div>
<div class="line"><span class="lineno">17444</span>    <span class="comment">// 1)</span></div>
<div class="line"><span class="lineno">17445</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17446</span>    <span class="comment">// Generate the digits of the integral part p1 = d[n-1]...d[1]d[0]</span></div>
<div class="line"><span class="lineno">17447</span> </div>
<div class="line"><span class="lineno">17448</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(p1 &gt; 0);</div>
<div class="line"><span class="lineno">17449</span> </div>
<div class="line"><span class="lineno">17450</span>    std::uint32_t pow10{};</div>
<div class="line"><span class="lineno">17451</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> k = find_largest_pow10(p1, pow10);</div>
<div class="line"><span class="lineno">17452</span> </div>
<div class="line"><span class="lineno">17453</span>    <span class="comment">//      10^(k-1) &lt;= p1 &lt; 10^k, pow10 = 10^(k-1)</span></div>
<div class="line"><span class="lineno">17454</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17455</span>    <span class="comment">//      p1 = (p1 div 10^(k-1)) * 10^(k-1) + (p1 mod 10^(k-1))</span></div>
<div class="line"><span class="lineno">17456</span>    <span class="comment">//         = (d[k-1]         ) * 10^(k-1) + (p1 mod 10^(k-1))</span></div>
<div class="line"><span class="lineno">17457</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17458</span>    <span class="comment">//      M+ = p1                                             + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17459</span>    <span class="comment">//         = d[k-1] * 10^(k-1) + (p1 mod 10^(k-1))          + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17460</span>    <span class="comment">//         = d[k-1] * 10^(k-1) + ((p1 mod 10^(k-1)) * 2^-e + p2) * 2^e</span></div>
<div class="line"><span class="lineno">17461</span>    <span class="comment">//         = d[k-1] * 10^(k-1) + (                         rest) * 2^e</span></div>
<div class="line"><span class="lineno">17462</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17463</span>    <span class="comment">// Now generate the digits d[n] of p1 from left to right (n = k-1,...,0)</span></div>
<div class="line"><span class="lineno">17464</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17465</span>    <span class="comment">//      p1 = d[k-1]...d[n] * 10^n + d[n-1]...d[0]</span></div>
<div class="line"><span class="lineno">17466</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17467</span>    <span class="comment">// but stop as soon as</span></div>
<div class="line"><span class="lineno">17468</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17469</span>    <span class="comment">//      rest * 2^e = (d[n-1]...d[0] * 2^-e + p2) * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><span class="lineno">17470</span> </div>
<div class="line"><span class="lineno">17471</span>    <span class="keywordtype">int</span> n = k;</div>
<div class="line"><span class="lineno">17472</span>    <span class="keywordflow">while</span> (n &gt; 0)</div>
<div class="line"><span class="lineno">17473</span>    {</div>
<div class="line"><span class="lineno">17474</span>        <span class="comment">// Invariants:</span></div>
<div class="line"><span class="lineno">17475</span>        <span class="comment">//      M+ = buffer * 10^n + (p1 + p2 * 2^e)    (buffer = 0 for n = k)</span></div>
<div class="line"><span class="lineno">17476</span>        <span class="comment">//      pow10 = 10^(n-1) &lt;= p1 &lt; 10^n</span></div>
<div class="line"><span class="lineno">17477</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17478</span>        <span class="keyword">const</span> std::uint32_t <a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a> = p1 / pow10;  <span class="comment">// d = p1 div 10^(n-1)</span></div>
<div class="line"><span class="lineno">17479</span>        <span class="keyword">const</span> std::uint32_t r = p1 % pow10;  <span class="comment">// r = p1 mod 10^(n-1)</span></div>
<div class="line"><span class="lineno">17480</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17481</span>        <span class="comment">//      M+ = buffer * 10^n + (d * 10^(n-1) + r) + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17482</span>        <span class="comment">//         = (buffer * 10 + d) * 10^(n-1) + (r + p2 * 2^e)</span></div>
<div class="line"><span class="lineno">17483</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17484</span>        <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(<a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a> &lt;= 9);</div>
<div class="line"><span class="lineno">17485</span>        buffer[length++] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + <a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a>); <span class="comment">// buffer := buffer * 10 + d</span></div>
<div class="line"><span class="lineno">17486</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17487</span>        <span class="comment">//      M+ = buffer * 10^(n-1) + (r + p2 * 2^e)</span></div>
<div class="line"><span class="lineno">17488</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17489</span>        p1 = r;</div>
<div class="line"><span class="lineno">17490</span>        n--;</div>
<div class="line"><span class="lineno">17491</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17492</span>        <span class="comment">//      M+ = buffer * 10^n + (p1 + p2 * 2^e)</span></div>
<div class="line"><span class="lineno">17493</span>        <span class="comment">//      pow10 = 10^n</span></div>
<div class="line"><span class="lineno">17494</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17495</span> </div>
<div class="line"><span class="lineno">17496</span>        <span class="comment">// Now check if enough digits have been generated.</span></div>
<div class="line"><span class="lineno">17497</span>        <span class="comment">// Compute</span></div>
<div class="line"><span class="lineno">17498</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17499</span>        <span class="comment">//      p1 + p2 * 2^e = (p1 * 2^-e + p2) * 2^e = rest * 2^e</span></div>
<div class="line"><span class="lineno">17500</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17501</span>        <span class="comment">// Note:</span></div>
<div class="line"><span class="lineno">17502</span>        <span class="comment">// Since rest and delta share the same exponent e, it suffices to</span></div>
<div class="line"><span class="lineno">17503</span>        <span class="comment">// compare the significands.</span></div>
<div class="line"><span class="lineno">17504</span>        <span class="keyword">const</span> std::uint64_t rest = (std::uint64_t{p1} &lt;&lt; -one.e) + p2;</div>
<div class="line"><span class="lineno">17505</span>        <span class="keywordflow">if</span> (rest &lt;= delta)</div>
<div class="line"><span class="lineno">17506</span>        {</div>
<div class="line"><span class="lineno">17507</span>            <span class="comment">// V = buffer * 10^n, with M- &lt;= V &lt;= M+.</span></div>
<div class="line"><span class="lineno">17508</span> </div>
<div class="line"><span class="lineno">17509</span>            decimal_exponent += n;</div>
<div class="line"><span class="lineno">17510</span> </div>
<div class="line"><span class="lineno">17511</span>            <span class="comment">// We may now just stop. But instead look if the buffer could be</span></div>
<div class="line"><span class="lineno">17512</span>            <span class="comment">// decremented to bring V closer to w.</span></div>
<div class="line"><span class="lineno">17513</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">17514</span>            <span class="comment">// pow10 = 10^n is now 1 ulp in the decimal representation V.</span></div>
<div class="line"><span class="lineno">17515</span>            <span class="comment">// The rounding procedure works with diyfp&#39;s with an implicit</span></div>
<div class="line"><span class="lineno">17516</span>            <span class="comment">// exponent of e.</span></div>
<div class="line"><span class="lineno">17517</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">17518</span>            <span class="comment">//      10^n = (10^n * 2^-e) * 2^e = ulp * 2^e</span></div>
<div class="line"><span class="lineno">17519</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">17520</span>            <span class="keyword">const</span> std::uint64_t ten_n = std::uint64_t{pow10} &lt;&lt; -one.e;</div>
<div class="line"><span class="lineno">17521</span>            <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#a73a15efcb5c2157ea0e1375b98ef0e83">grisu2_round</a>(buffer, length, dist, delta, rest, ten_n);</div>
<div class="line"><span class="lineno">17522</span> </div>
<div class="line"><span class="lineno">17523</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">17524</span>        }</div>
<div class="line"><span class="lineno">17525</span> </div>
<div class="line"><span class="lineno">17526</span>        pow10 /= 10;</div>
<div class="line"><span class="lineno">17527</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17528</span>        <span class="comment">//      pow10 = 10^(n-1) &lt;= p1 &lt; 10^n</span></div>
<div class="line"><span class="lineno">17529</span>        <span class="comment">// Invariants restored.</span></div>
<div class="line"><span class="lineno">17530</span>    }</div>
<div class="line"><span class="lineno">17531</span> </div>
<div class="line"><span class="lineno">17532</span>    <span class="comment">// 2)</span></div>
<div class="line"><span class="lineno">17533</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17534</span>    <span class="comment">// The digits of the integral part have been generated:</span></div>
<div class="line"><span class="lineno">17535</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17536</span>    <span class="comment">//      M+ = d[k-1]...d[1]d[0] + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17537</span>    <span class="comment">//         = buffer            + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17538</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17539</span>    <span class="comment">// Now generate the digits of the fractional part p2 * 2^e.</span></div>
<div class="line"><span class="lineno">17540</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17541</span>    <span class="comment">// Note:</span></div>
<div class="line"><span class="lineno">17542</span>    <span class="comment">// No decimal point is generated: the exponent is adjusted instead.</span></div>
<div class="line"><span class="lineno">17543</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17544</span>    <span class="comment">// p2 actually represents the fraction</span></div>
<div class="line"><span class="lineno">17545</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17546</span>    <span class="comment">//      p2 * 2^e</span></div>
<div class="line"><span class="lineno">17547</span>    <span class="comment">//          = p2 / 2^-e</span></div>
<div class="line"><span class="lineno">17548</span>    <span class="comment">//          = d[-1] / 10^1 + d[-2] / 10^2 + ...</span></div>
<div class="line"><span class="lineno">17549</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17550</span>    <span class="comment">// Now generate the digits d[-m] of p1 from left to right (m = 1,2,...)</span></div>
<div class="line"><span class="lineno">17551</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17552</span>    <span class="comment">//      p2 * 2^e = d[-1]d[-2]...d[-m] * 10^-m</span></div>
<div class="line"><span class="lineno">17553</span>    <span class="comment">//                      + 10^-m * (d[-m-1] / 10^1 + d[-m-2] / 10^2 + ...)</span></div>
<div class="line"><span class="lineno">17554</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17555</span>    <span class="comment">// using</span></div>
<div class="line"><span class="lineno">17556</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17557</span>    <span class="comment">//      10^m * p2 = ((10^m * p2) div 2^-e) * 2^-e + ((10^m * p2) mod 2^-e)</span></div>
<div class="line"><span class="lineno">17558</span>    <span class="comment">//                = (                   d) * 2^-e + (                   r)</span></div>
<div class="line"><span class="lineno">17559</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17560</span>    <span class="comment">// or</span></div>
<div class="line"><span class="lineno">17561</span>    <span class="comment">//      10^m * p2 * 2^e = d + r * 2^e</span></div>
<div class="line"><span class="lineno">17562</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17563</span>    <span class="comment">// i.e.</span></div>
<div class="line"><span class="lineno">17564</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17565</span>    <span class="comment">//      M+ = buffer + p2 * 2^e</span></div>
<div class="line"><span class="lineno">17566</span>    <span class="comment">//         = buffer + 10^-m * (d + r * 2^e)</span></div>
<div class="line"><span class="lineno">17567</span>    <span class="comment">//         = (buffer * 10^m + d) * 10^-m + 10^-m * r * 2^e</span></div>
<div class="line"><span class="lineno">17568</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17569</span>    <span class="comment">// and stop as soon as 10^-m * r * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><span class="lineno">17570</span> </div>
<div class="line"><span class="lineno">17571</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(p2 &gt; delta);</div>
<div class="line"><span class="lineno">17572</span> </div>
<div class="line"><span class="lineno">17573</span>    <span class="keywordtype">int</span> m = 0;</div>
<div class="line"><span class="lineno">17574</span>    <span class="keywordflow">for</span> (;;)</div>
<div class="line"><span class="lineno">17575</span>    {</div>
<div class="line"><span class="lineno">17576</span>        <span class="comment">// Invariant:</span></div>
<div class="line"><span class="lineno">17577</span>        <span class="comment">//      M+ = buffer * 10^-m + 10^-m * (d[-m-1] / 10 + d[-m-2] / 10^2 + ...) * 2^e</span></div>
<div class="line"><span class="lineno">17578</span>        <span class="comment">//         = buffer * 10^-m + 10^-m * (p2                                 ) * 2^e</span></div>
<div class="line"><span class="lineno">17579</span>        <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * (10 * p2)                   ) * 2^e</span></div>
<div class="line"><span class="lineno">17580</span>        <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * ((10*p2 div 2^-e) * 2^-e + (10*p2 mod 2^-e)) * 2^e</span></div>
<div class="line"><span class="lineno">17581</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17582</span>        <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(p2 &lt;= (std::numeric_limits&lt;std::uint64_t&gt;::max)() / 10);</div>
<div class="line"><span class="lineno">17583</span>        p2 *= 10;</div>
<div class="line"><span class="lineno">17584</span>        <span class="keyword">const</span> std::uint64_t <a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a> = p2 &gt;&gt; -one.e;     <span class="comment">// d = (10 * p2) div 2^-e</span></div>
<div class="line"><span class="lineno">17585</span>        <span class="keyword">const</span> std::uint64_t r = p2 &amp; (one.f - 1); <span class="comment">// r = (10 * p2) mod 2^-e</span></div>
<div class="line"><span class="lineno">17586</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17587</span>        <span class="comment">//      M+ = buffer * 10^-m + 10^-m * (1/10 * (d * 2^-e + r) * 2^e</span></div>
<div class="line"><span class="lineno">17588</span>        <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * (d + r * 2^e))</span></div>
<div class="line"><span class="lineno">17589</span>        <span class="comment">//         = (buffer * 10 + d) * 10^(-m-1) + 10^(-m-1) * r * 2^e</span></div>
<div class="line"><span class="lineno">17590</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17591</span>        <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(<a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a> &lt;= 9);</div>
<div class="line"><span class="lineno">17592</span>        buffer[length++] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + <a class="code hl_variable" href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a>); <span class="comment">// buffer := buffer * 10 + d</span></div>
<div class="line"><span class="lineno">17593</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17594</span>        <span class="comment">//      M+ = buffer * 10^(-m-1) + 10^(-m-1) * r * 2^e</span></div>
<div class="line"><span class="lineno">17595</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17596</span>        p2 = r;</div>
<div class="line"><span class="lineno">17597</span>        m++;</div>
<div class="line"><span class="lineno">17598</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17599</span>        <span class="comment">//      M+ = buffer * 10^-m + 10^-m * p2 * 2^e</span></div>
<div class="line"><span class="lineno">17600</span>        <span class="comment">// Invariant restored.</span></div>
<div class="line"><span class="lineno">17601</span> </div>
<div class="line"><span class="lineno">17602</span>        <span class="comment">// Check if enough digits have been generated.</span></div>
<div class="line"><span class="lineno">17603</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">17604</span>        <span class="comment">//      10^-m * p2 * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><span class="lineno">17605</span>        <span class="comment">//              p2 * 2^e &lt;= 10^m * delta * 2^e</span></div>
<div class="line"><span class="lineno">17606</span>        <span class="comment">//                    p2 &lt;= 10^m * delta</span></div>
<div class="line"><span class="lineno">17607</span>        delta *= 10;</div>
<div class="line"><span class="lineno">17608</span>        dist  *= 10;</div>
<div class="line"><span class="lineno">17609</span>        <span class="keywordflow">if</span> (p2 &lt;= delta)</div>
<div class="line"><span class="lineno">17610</span>        {</div>
<div class="line"><span class="lineno">17611</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">17612</span>        }</div>
<div class="line"><span class="lineno">17613</span>    }</div>
<div class="line"><span class="lineno">17614</span> </div>
<div class="line"><span class="lineno">17615</span>    <span class="comment">// V = buffer * 10^-m, with M- &lt;= V &lt;= M+.</span></div>
<div class="line"><span class="lineno">17616</span> </div>
<div class="line"><span class="lineno">17617</span>    decimal_exponent -= m;</div>
<div class="line"><span class="lineno">17618</span> </div>
<div class="line"><span class="lineno">17619</span>    <span class="comment">// 1 ulp in the decimal representation is now 10^-m.</span></div>
<div class="line"><span class="lineno">17620</span>    <span class="comment">// Since delta and dist are now scaled by 10^m, we need to do the</span></div>
<div class="line"><span class="lineno">17621</span>    <span class="comment">// same with ulp in order to keep the units in sync.</span></div>
<div class="line"><span class="lineno">17622</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17623</span>    <span class="comment">//      10^m * 10^-m = 1 = 2^-e * 2^e = ten_m * 2^e</span></div>
<div class="line"><span class="lineno">17624</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17625</span>    <span class="keyword">const</span> std::uint64_t ten_m = one.f;</div>
<div class="line"><span class="lineno">17626</span>    <a class="code hl_function" href="namespacedetail_1_1dtoa__impl.html#a73a15efcb5c2157ea0e1375b98ef0e83">grisu2_round</a>(buffer, length, dist, delta, p2, ten_m);</div>
<div class="line"><span class="lineno">17627</span> </div>
<div class="line"><span class="lineno">17628</span>    <span class="comment">// By construction this algorithm generates the shortest possible decimal</span></div>
<div class="line"><span class="lineno">17629</span>    <span class="comment">// number (Loitsch, Theorem 6.2) which rounds back to w.</span></div>
<div class="line"><span class="lineno">17630</span>    <span class="comment">// For an input number of precision p, at least</span></div>
<div class="line"><span class="lineno">17631</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17632</span>    <span class="comment">//      N = 1 + ceil(p * log_10(2))</span></div>
<div class="line"><span class="lineno">17633</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17634</span>    <span class="comment">// decimal digits are sufficient to identify all binary floating-point</span></div>
<div class="line"><span class="lineno">17635</span>    <span class="comment">// numbers (Matula, &quot;In-and-Out conversions&quot;).</span></div>
<div class="line"><span class="lineno">17636</span>    <span class="comment">// This implies that the algorithm does not produce more than N decimal</span></div>
<div class="line"><span class="lineno">17637</span>    <span class="comment">// digits.</span></div>
<div class="line"><span class="lineno">17638</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17639</span>    <span class="comment">//      N = 17 for p = 53 (IEEE double precision)</span></div>
<div class="line"><span class="lineno">17640</span>    <span class="comment">//      N = 9  for p = 24 (IEEE single precision)</span></div>
<div class="line"><span class="lineno">17641</span>}</div>
<div class="ttc" id="aaddm__nll_8cpp_html_a3fbbd8a3959e76a2bc3455d3bade52dc"><div class="ttname"><a href="addm__nll_8cpp.html#a3fbbd8a3959e76a2bc3455d3bade52dc">d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition</b> <a href="addm__nll_8cpp_source.html#l00011">addm_nll.cpp:11</a></div></div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_a73a15efcb5c2157ea0e1375b98ef0e83"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#a73a15efcb5c2157ea0e1375b98ef0e83">detail::dtoa_impl::grisu2_round</a></div><div class="ttdeci">void grisu2_round(char *buf, int len, std::uint64_t dist, std::uint64_t delta, std::uint64_t rest, std::uint64_t ten_k)</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17367">json.hpp:17367</a></div></div>
<div class="ttc" id="anamespacedetail_1_1dtoa__impl_html_ae152a095d2dd1a6dd41ef8ad39c26e19"><div class="ttname"><a href="namespacedetail_1_1dtoa__impl.html#ae152a095d2dd1a6dd41ef8ad39c26e19">detail::dtoa_impl::kGamma</a></div><div class="ttdeci">constexpr int kGamma</div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l17133">json.hpp:17133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a73a15efcb5c2157ea0e1375b98ef0e83" name="a73a15efcb5c2157ea0e1375b98ef0e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a15efcb5c2157ea0e1375b98ef0e83">&#9670;&#160;</a></span>grisu2_round()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void detail::dtoa_impl::grisu2_round </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint64_t&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint64_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint64_t&#160;</td>
          <td class="paramname"><em>rest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint64_t&#160;</td>
          <td class="paramname"><em>ten_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17367">17367</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">17369</span>{</div>
<div class="line"><span class="lineno">17370</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(len &gt;= 1);</div>
<div class="line"><span class="lineno">17371</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(dist &lt;= delta);</div>
<div class="line"><span class="lineno">17372</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(rest &lt;= delta);</div>
<div class="line"><span class="lineno">17373</span>    <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(ten_k &gt; 0);</div>
<div class="line"><span class="lineno">17374</span> </div>
<div class="line"><span class="lineno">17375</span>    <span class="comment">//               &lt;--------------------------- delta ----&gt;</span></div>
<div class="line"><span class="lineno">17376</span>    <span class="comment">//                                  &lt;---- dist ---------&gt;</span></div>
<div class="line"><span class="lineno">17377</span>    <span class="comment">// --------------[------------------+-------------------]--------------</span></div>
<div class="line"><span class="lineno">17378</span>    <span class="comment">//               M-                 w                   M+</span></div>
<div class="line"><span class="lineno">17379</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17380</span>    <span class="comment">//                                  ten_k</span></div>
<div class="line"><span class="lineno">17381</span>    <span class="comment">//                                &lt;------&gt;</span></div>
<div class="line"><span class="lineno">17382</span>    <span class="comment">//                                       &lt;---- rest ----&gt;</span></div>
<div class="line"><span class="lineno">17383</span>    <span class="comment">// --------------[------------------+----+--------------]--------------</span></div>
<div class="line"><span class="lineno">17384</span>    <span class="comment">//                                  w    V</span></div>
<div class="line"><span class="lineno">17385</span>    <span class="comment">//                                       = buf * 10^k</span></div>
<div class="line"><span class="lineno">17386</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">17387</span>    <span class="comment">// ten_k represents a unit-in-the-last-place in the decimal representation</span></div>
<div class="line"><span class="lineno">17388</span>    <span class="comment">// stored in buf.</span></div>
<div class="line"><span class="lineno">17389</span>    <span class="comment">// Decrement buf by ten_k while this takes buf closer to w.</span></div>
<div class="line"><span class="lineno">17390</span> </div>
<div class="line"><span class="lineno">17391</span>    <span class="comment">// The tests are written in this order to avoid overflow in unsigned</span></div>
<div class="line"><span class="lineno">17392</span>    <span class="comment">// integer arithmetic.</span></div>
<div class="line"><span class="lineno">17393</span> </div>
<div class="line"><span class="lineno">17394</span>    <span class="keywordflow">while</span> (rest &lt; dist</div>
<div class="line"><span class="lineno">17395</span>            &amp;&amp; delta - rest &gt;= ten_k</div>
<div class="line"><span class="lineno">17396</span>            &amp;&amp; (rest + ten_k &lt; dist || dist - rest &gt; rest + ten_k - dist))</div>
<div class="line"><span class="lineno">17397</span>    {</div>
<div class="line"><span class="lineno">17398</span>        <a class="code hl_define" href="json_8hpp.html#a69f131cff49da1989667220173fbeae6">JSON_ASSERT</a>(buf[len - 1] != <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><span class="lineno">17399</span>        buf[len - 1]--;</div>
<div class="line"><span class="lineno">17400</span>        rest += ten_k;</div>
<div class="line"><span class="lineno">17401</span>    }</div>
<div class="line"><span class="lineno">17402</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c879bf97b806cacbcbb2da07a5ff5c8" name="a3c879bf97b806cacbcbb2da07a5ff5c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c879bf97b806cacbcbb2da07a5ff5c8">&#9670;&#160;</a></span>reinterpret_bits()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Target , typename Source &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Target detail::dtoa_impl::reinterpret_bits </td>
          <td>(</td>
          <td class="paramtype">const Source&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l16869">16869</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">16870</span>{</div>
<div class="line"><span class="lineno">16871</span>    <span class="keyword">static_assert</span>(<span class="keyword">sizeof</span>(Target) == <span class="keyword">sizeof</span>(Source), <span class="stringliteral">&quot;size mismatch&quot;</span>);</div>
<div class="line"><span class="lineno">16872</span> </div>
<div class="line"><span class="lineno">16873</span>    Target target;</div>
<div class="line"><span class="lineno">16874</span>    std::memcpy(&amp;target, &amp;source, <span class="keyword">sizeof</span>(Source));</div>
<div class="line"><span class="lineno">16875</span>    <span class="keywordflow">return</span> target;</div>
<div class="line"><span class="lineno">16876</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a95c569b7627a9372686f1f77d73e8660" name="a95c569b7627a9372686f1f77d73e8660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95c569b7627a9372686f1f77d73e8660">&#9670;&#160;</a></span>kAlpha</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int detail::dtoa_impl::kAlpha = -60</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17132">17132</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>

</div>
</div>
<a id="ae152a095d2dd1a6dd41ef8ad39c26e19" name="ae152a095d2dd1a6dd41ef8ad39c26e19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae152a095d2dd1a6dd41ef8ad39c26e19">&#9670;&#160;</a></span>kGamma</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int detail::dtoa_impl::kGamma = -32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="json_8hpp_source.html#l17133">17133</a> of file <a class="el" href="json_8hpp_source.html">json.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
